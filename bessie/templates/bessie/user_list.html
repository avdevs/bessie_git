{% extends 'bessie/dashboard.html' %}
{% block content %}
<div class="section">
    <div style="display: flex; width: 100%; justify-content: space-between;">
        <h2 class="section-title">{{ company.name }} Employees</h2>
    </div>
    <table>
        <thead>
            <tr>
                <th>First Name</th>
                <th>Last Name</th>
                <th>Email</th>
                {% if request.user.is_staff or request.user.user_type == "COMPANY_ADMIN" %}
                <th>Quiz Status</th>
                <th>View Results</th>
                <th>Export Data</th>
                {% endif %}
            </tr>
        </thead>
        <tbody>
            {% for item in page_obj %}
            <tr>
                <td>{{ item.user.first_name }}</td>
                <td>{{ item.user.last_name }}</td>
                <td>{{ item.user.email }}</td>

                {% if request.user.is_staff or request.user.user_type == "COMPANY_ADMIN" %}
                    {% if item.has_response > 0 %}
                        <td><span class="badge badge-success">Completed</span></td>
                    {% else %}
                        <td><span class="badge badge-warning">Pending</span></td>
                    {% endif %}    
                    <td><a href="{% url 'view_results' item.id %}" style="margin-bottom: 0;">View Results</a></td>
                    {% if item.has_response > 0 %}
                        <td><a href="{% url 'export_data' item.id %}" style="margin-bottom: 0;">Export Data</a></td>
                    {% endif %}
                {% endif %}
            </tr>
            {% endfor %}
        </tbody>
    </table>
    <div class="pagination" id="pagination">
        {% if page_obj.has_previous %}
            <a href="?page=1">&laquo; first</a>
            <a href="?page={{ page_obj.previous_page_number }}">previous</a>
        {% endif %}
        <span class="current">
            Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}.
        </span>
        {% if page_obj.has_next %}
            <a href="?page={{ page_obj.next_page_number }}">next</a>
            <a href="?page={{ page_obj.paginator.num_pages }}">last &raquo;</a>
        {% endif %}
    </div>
</div>
{% endblock %}

